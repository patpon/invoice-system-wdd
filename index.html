<!DOCTYPE html>
<html lang="th">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ö‡∏¥‡∏•‡πÅ‡∏•‡∏∞‡πÉ‡∏ö‡∏Å‡∏≥‡∏Å‡∏±‡∏ö‡∏†‡∏≤‡∏©‡∏µ</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/styles.css">
</head>

<body>
    <!-- Header -->
    <header class="header">
        <div class="header-left">
            <div class="logo-container" id="logoContainer">
                <img src="" alt="Logo" id="logoPreview" class="logo-img hidden">
                <button class="btn-delete-logo hidden" id="deleteLogoBtn" title="‡∏•‡∏ö‡πÇ‡∏•‡πÇ‡∏Å‡πâ">‚úï</button>
                <div class="logo-placeholder" id="logoPlaceholder">
                    <span class="logo-icon">üè™</span>
                    <span>‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÇ‡∏•‡πÇ‡∏Å‡πâ</span>
                    <small>‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥: 200√ó80 px</small>
                </div>
                <input type="file" id="logoInput" accept="image/*" hidden>
            </div>
            <h1 class="app-title">‡∏£‡∏∞‡∏ö‡∏ö‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ö‡∏¥‡∏•‡πÅ‡∏•‡∏∞‡πÉ‡∏ö‡∏Å‡∏≥‡∏Å‡∏±‡∏ö‡∏†‡∏≤‡∏©‡∏µ</h1>
        </div>
        <div class="header-right">
            <!-- User Info -->
            <div class="user-info" id="userInfo"
                style="display: flex; align-items: center; gap: 10px; margin-right: 15px;">
                <span id="userDisplayName" style="font-size: 14px; color: #cbd5e1;">üë§ -</span>
            </div>
            <button class="btn btn-icon" id="dashboardBtn" title="Dashboard">
                <span>üìä</span>
            </button>
            <button class="btn btn-icon" id="historyBtn" title="‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡πÉ‡∏ö‡∏Å‡∏≥‡∏Å‡∏±‡∏ö">
                <span>üìã</span>
            </button>
            <button class="btn btn-icon" id="settingsBtn" title="‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤">
                <span>‚öôÔ∏è</span>
            </button>
            <button class="btn btn-icon btn-logout" id="logoutBtn" title="‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö" style="color: #f87171;">
                <span>üö™</span>
            </button>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Navigation Tabs -->
        <nav class="nav-tabs">
            <button class="tab-btn active" data-tab="invoice">üßæ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏ö‡∏Å‡∏≥‡∏Å‡∏±‡∏ö‡∏†‡∏≤‡∏©‡∏µ</button>
            <button class="tab-btn" data-tab="customers">üë• ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</button>
            <button class="tab-btn" data-tab="dashboard">üìä Dashboard</button>
            <button class="tab-btn" data-tab="history">üìã ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡πÉ‡∏ö‡∏Å‡∏≥‡∏Å‡∏±‡∏ö</button>
        </nav>

        <!-- Tab Contents -->
        <div class="tab-contents">
            <!-- Invoice Tab -->
            <div class="tab-content active" id="invoiceTab">
                <div class="invoice-layout">
                    <!-- Left Panel - Form -->
                    <div class="form-panel">
                        <div class="card">
                            <div class="card-header">
                                <h2>üìù ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ö‡∏Å‡∏≥‡∏Å‡∏±‡∏ö‡∏†‡∏≤‡∏©‡∏µ</h2>
                            </div>
                            <div class="card-body">
                                <!-- Invoice Info -->
                                <div class="form-section">
                                    <h3>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ö‡∏Å‡∏≥‡∏Å‡∏±‡∏ö</h3>
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label>‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÉ‡∏ö‡∏Å‡∏≥‡∏Å‡∏±‡∏ö</label>
                                            <div style="display: flex; gap: 8px; align-items: center;">
                                                <input type="text" id="invoiceNumber" readonly style="flex: 1;">
                                                <button type="button" class="btn btn-secondary btn-sm"
                                                    id="syncInvoiceBtn"
                                                    title="‡∏î‡∏∂‡∏á‡πÄ‡∏•‡∏Ç‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏à‡∏≤‡∏Å Google Sheets">üîÑ</button>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</label>
                                            <input type="date" id="invoiceDate">
                                        </div>
                                    </div>
                                </div>

                                <!-- Customer Info -->
                                <div class="form-section">
                                    <h3>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</h3>
                                    <div class="form-group">
                                        <label>‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</label>
                                        <div class="search-container">
                                            <input type="text" id="customerSearch"
                                                placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏´‡∏±‡∏™‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤...">
                                            <div class="search-results" id="customerResults"></div>
                                        </div>
                                        <button class="btn btn-secondary btn-sm" id="newCustomerBtn">+
                                            ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÉ‡∏´‡∏°‡πà</button>
                                    </div>
                                    <div class="form-group">
                                        <label>‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤/‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó <span class="required">*</span></label>
                                        <input type="text" id="customerName" required>
                                    </div>
                                    <div class="form-group">
                                        <label>‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà</label>
                                        <textarea id="customerAddress" rows="2"></textarea>
                                    </div>
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label>‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏ú‡∏π‡πâ‡πÄ‡∏™‡∏µ‡∏¢‡∏†‡∏≤‡∏©‡∏µ</label>
                                            <input type="text" id="customerTaxId" maxlength="13">
                                        </div>
                                        <div class="form-group">
                                            <label>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå</label>
                                            <input type="tel" id="customerPhone">
                                        </div>
                                    </div>
                                    <!-- Branch Selection -->
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</label>
                                            <div class="radio-group">
                                                <label class="radio-label">
                                                    <input type="radio" name="branchType" id="branchTypeHQ" value="hq"
                                                        checked>
                                                    <span>‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏ç‡πà</span>
                                                </label>
                                                <label class="radio-label">
                                                    <input type="radio" name="branchType" id="branchTypeBranch"
                                                        value="branch">
                                                    <span>‡∏™‡∏≤‡∏Ç‡∏≤‡∏ó‡∏µ‡πà</span>
                                                </label>
                                            </div>
                                        </div>
                                        <div class="form-group" id="branchNumberGroup" style="display: none;">
                                            <label>‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏™‡∏≤‡∏Ç‡∏≤</label>
                                            <input type="text" id="branchNumber" placeholder="‡πÄ‡∏ä‡πà‡∏ô 00015" maxlength="5">
                                        </div>
                                    </div>
                                </div>

                                <!-- Items -->
                                <div class="form-section">
                                    <h3>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤/‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£</h3>
                                    <div class="items-table-container">
                                        <table class="items-table" id="itemsTable">
                                            <thead>
                                                <tr>
                                                    <th>‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>
                                                    <th>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</th>
                                                    <th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</th>
                                                    <th>‡∏£‡∏≤‡∏Ñ‡∏≤/‡∏´‡∏ô‡πà‡∏ß‡∏¢</th>
                                                    <th>‡∏£‡∏ß‡∏°</th>
                                                    <th></th>
                                                </tr>
                                            </thead>
                                            <tbody id="itemsBody">
                                                <!-- Items will be added here -->
                                            </tbody>
                                        </table>
                                    </div>
                                    <button class="btn btn-secondary" id="addItemBtn">+ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</button>
                                </div>

                                <!-- Totals -->
                                <div class="totals-section">
                                    <div class="total-row">
                                        <span>‡∏£‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ß‡∏°</span>
                                        <span id="subtotal">0.00 ‡∏ö‡∏≤‡∏ó</span>
                                    </div>
                                    <div class="total-row">
                                        <span>VAT 7%</span>
                                        <span id="vatAmount">0.00 ‡∏ö‡∏≤‡∏ó</span>
                                    </div>
                                    <div class="total-row grand-total">
                                        <span>‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏¥‡πâ‡∏ô</span>
                                        <span id="grandTotal">0.00 ‡∏ö‡∏≤‡∏ó</span>
                                    </div>
                                    <div class="total-text" id="totalText">
                                        (‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ö‡∏≤‡∏ó‡∏ñ‡πâ‡∏ß‡∏ô)
                                    </div>
                                </div>

                                <!-- Payment Method -->
                                <div class="form-section">
                                    <h3>üíµ ‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</h3>
                                    <div class="payment-options">
                                        <div class="payment-option">
                                            <label class="checkbox-label">
                                                <input type="checkbox" id="paymentCash" checked>
                                                <span>‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î</span>
                                            </label>
                                            <input type="number" id="paymentCashAmount" class="payment-amount"
                                                placeholder="‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô" step="0.01">
                                            <span class="payment-unit">‡∏ö‡∏≤‡∏ó</span>
                                        </div>
                                        <div class="payment-option">
                                            <label class="checkbox-label">
                                                <input type="checkbox" id="paymentTransfer">
                                                <span>‡πÄ‡∏á‡∏¥‡∏ô‡πÇ‡∏≠‡∏ô</span>
                                            </label>
                                            <input type="number" id="paymentTransferAmount" class="payment-amount"
                                                placeholder="‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô" step="0.01" disabled>
                                            <span class="payment-unit">‡∏ö‡∏≤‡∏ó</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Right Panel - Preview -->
                    <div class="preview-panel">
                        <div class="card">
                            <div class="card-header">
                                <h2>üëÅÔ∏è ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÉ‡∏ö‡∏Å‡∏≥‡∏Å‡∏±‡∏ö‡∏†‡∏≤‡∏©‡∏µ</h2>
                            </div>
                            <div class="card-body">
                                <div class="invoice-preview" id="invoicePreview">
                                    <!-- Preview content will be generated here -->
                                </div>
                            </div>
                            <div class="card-footer">
                                <div class="print-options" style="display: none;">
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="includeCopy">
                                        <span>‡∏û‡∏¥‡∏°‡∏û‡πå‡∏™‡∏≥‡πÄ‡∏ô‡∏≤ (‡∏ï‡πâ‡∏ô‡∏â‡∏ö‡∏±‡∏ö + ‡∏™‡∏≥‡πÄ‡∏ô‡∏≤)</span>
                                    </label>
                                </div>
                                <div class="print-buttons">
                                    <button class="btn btn-primary btn-lg" id="printBtn" style="display: none;">
                                        üñ®Ô∏è ‡∏û‡∏¥‡∏°‡∏û‡πå
                                    </button>
                                    <button class="btn btn-secondary btn-lg" id="pdfBtn" style="display: none;">
                                        üìÑ PDF
                                    </button>
                                    <button class="btn btn-success btn-lg" id="saveBtn" style="display: none;">
                                        üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
                                    </button>
                                    <button class="btn btn-primary btn-lg" id="saveAndPrintBtn">
                                        üñ®Ô∏è ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å + ‡∏û‡∏¥‡∏°‡∏û‡πå
                                    </button>
                                    <button class="btn btn-info btn-lg" id="emailBtn" title="‡∏™‡πà‡∏á Email ‡∏û‡∏£‡πâ‡∏≠‡∏° PDF"
                                        style="display: none;">
                                        üìß ‡∏™‡πà‡∏á Email
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Customers Tab -->
            <div class="tab-content" id="customersTab">
                <div class="card">
                    <div class="card-header">
                        <h2>üë• ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</h2>
                        <button class="btn btn-primary" id="addCustomerBtn">+ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÉ‡∏´‡∏°‡πà</button>
                    </div>
                    <div class="card-body">
                        <div class="search-bar">
                            <input type="text" id="customerListSearch" placeholder="üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤...">
                            <button class="btn btn-secondary" id="refreshCustomersBtn">üîÑ ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä</button>
                        </div>
                        <div class="customers-table-container">
                            <table class="data-table" id="customersTable">
                                <thead>
                                    <tr>
                                        <th>‡∏£‡∏´‡∏±‡∏™</th>
                                        <th>‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤/‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó</th>
                                        <th>‡πÄ‡∏•‡∏Ç‡∏ú‡∏π‡πâ‡πÄ‡∏™‡∏µ‡∏¢‡∏†‡∏≤‡∏©‡∏µ</th>
                                        <th>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£</th>
                                        <th>‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                                    </tr>
                                </thead>
                                <tbody id="customersBody">
                                    <!-- Customers will be loaded here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Dashboard Tab -->
            <div class="tab-content" id="dashboardTab">
                <div class="dashboard-grid">
                    <!-- Date Filter Controls -->
                    <div class="dashboard-filters card">
                        <div class="card-body" style="padding: 15px;">
                            <div class="filter-row"
                                style="display: flex; flex-wrap: wrap; gap: 15px; align-items: center;">
                                <div class="filter-group">
                                    <label
                                        style="font-size: 14px; font-weight: 500; color: #64748b; margin-right: 8px;">üìÖ
                                        ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô:</label>
                                    <select id="dashboardMonth" class="filter-select">
                                        <option value="all">‡∏ó‡∏±‡πâ‡∏á‡∏õ‡∏µ</option>
                                        <option value="1">‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°</option>
                                        <option value="2">‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå</option>
                                        <option value="3">‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°</option>
                                        <option value="4">‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô</option>
                                        <option value="5">‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°</option>
                                        <option value="6">‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô</option>
                                        <option value="7">‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°</option>
                                        <option value="8">‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°</option>
                                        <option value="9">‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô</option>
                                        <option value="10">‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°</option>
                                        <option value="11">‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô</option>
                                        <option value="12">‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°</option>
                                    </select>
                                </div>
                                <div class="filter-group">
                                    <label
                                        style="font-size: 14px; font-weight: 500; color: #64748b; margin-right: 8px;">üìÜ
                                        ‡∏õ‡∏µ:</label>
                                    <select id="dashboardYear" class="filter-select">
                                        <!-- Years will be populated by JavaScript -->
                                    </select>
                                </div>
                                <div class="filter-divider" style="border-left: 1px solid #e2e8f0; height: 30px;"></div>
                                <div class="filter-group">
                                    <label
                                        style="font-size: 14px; font-weight: 500; color: #64748b; margin-right: 8px;">üóìÔ∏è
                                        ‡∏ä‡πà‡∏ß‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:</label>
                                    <input type="date" id="dashboardDateFrom" class="filter-input" title="‡∏à‡∏≤‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà">
                                    <span style="color: #64748b;">‡∏ñ‡∏∂‡∏á</span>
                                    <input type="date" id="dashboardDateTo" class="filter-input" title="‡∏ñ‡∏∂‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà">
                                    <button class="btn btn-primary btn-sm" id="applyDateRangeBtn">‡∏Å‡∏£‡∏≠‡∏á</button>
                                    <button class="btn btn-secondary btn-sm" id="resetFilterBtn">‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Stats Cards -->
                    <div class="stats-row">
                        <div class="stat-card">
                            <div class="stat-icon">üìÑ</div>
                            <div class="stat-info">
                                <h3 id="totalInvoices">0</h3>
                                <p>‡πÉ‡∏ö‡∏Å‡∏≥‡∏Å‡∏±‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">üí∞</div>
                            <div class="stat-info">
                                <h3 id="totalSales">‡∏ø0</h3>
                                <p>‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏£‡∏ß‡∏°</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">üìÖ</div>
                            <div class="stat-info">
                                <h3 id="todayInvoices">0</h3>
                                <p>‡πÉ‡∏ö‡∏Å‡∏≥‡∏Å‡∏±‡∏ö‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">üë•</div>
                            <div class="stat-info">
                                <h3 id="totalCustomers">0</h3>
                                <p>‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
                            </div>
                        </div>
                        <div class="stat-card stat-card-vat">
                            <div class="stat-icon">üìã</div>
                            <div class="stat-info">
                                <h3 id="totalVat">‡∏ø0</h3>
                                <p>‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏° VAT</p>
                            </div>
                        </div>
                        <div class="stat-card stat-card-danger">
                            <div class="stat-icon">‚ùå</div>
                            <div class="stat-info">
                                <h3 id="cancelledInvoices">0</h3>
                                <p>‡πÉ‡∏ö‡∏Å‡∏≥‡∏Å‡∏±‡∏ö‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</p>
                                <small id="cancelledAmount" class="stat-sub">‡∏ø0.00</small>
                            </div>
                        </div>
                    </div>

                    <!-- Charts -->
                    <div class="chart-container">
                        <div class="card">
                            <div class="card-header">
                                <h2>üìà ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</h2>
                            </div>
                            <div class="card-body">
                                <canvas id="salesChart"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Recent Invoices -->
                    <div class="card">
                        <div class="card-header">
                            <h2>üïê ‡πÉ‡∏ö‡∏Å‡∏≥‡∏Å‡∏±‡∏ö‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</h2>
                        </div>
                        <div class="card-body">
                            <table class="data-table" id="recentInvoicesTable">
                                <thead>
                                    <tr>
                                        <th>‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà</th>
                                        <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
                                        <th>‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</th>
                                        <th>‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°</th>
                                    </tr>
                                </thead>
                                <tbody id="recentInvoicesBody">
                                    <!-- Recent invoices will be loaded here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- History Tab -->
            <div class="tab-content" id="historyTab">
                <div class="card">
                    <div class="card-header">
                        <h2>üìã ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡πÉ‡∏ö‡∏Å‡∏≥‡∏Å‡∏±‡∏ö‡∏†‡∏≤‡∏©‡∏µ</h2>
                    </div>
                    <div class="card-body">
                        <div class="search-bar">
                            <input type="text" id="invoiceSearch" placeholder="üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÉ‡∏ö‡∏Å‡∏≥‡∏Å‡∏±‡∏ö...">
                            <input type="date" id="searchDateFrom" title="‡∏à‡∏≤‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà">
                            <input type="date" id="searchDateTo" title="‡∏ñ‡∏∂‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà">
                            <button class="btn btn-primary" id="searchInvoiceBtn">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</button>
                            <button class="btn btn-secondary" id="syncHistoryBtn" title="‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Google Sheets">üîÑ
                                Sync ‡∏à‡∏≤‡∏Å Sheets</button>
                            <button class="btn btn-danger" id="clearHistoryBtn" title="‡∏•‡∏ö‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô Local">üóëÔ∏è
                                ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
                            <div class="export-buttons" style="display: inline-flex; gap: 8px; margin-left: 10px;">
                                <button class="btn btn-export-pdf" id="exportHistoryPdfBtn" title="‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô PDF">
                                    üìÑ PDF
                                </button>
                                <button class="btn btn-export-excel" id="exportHistoryExcelBtn"
                                    title="‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô Excel">
                                    üìä Excel
                                </button>
                            </div>
                            <label class="checkbox-label" style="margin-left: 15px; display: none;">
                                <input type="checkbox" id="historyIncludeCopy">
                                <span>‡∏û‡∏¥‡∏°‡∏û‡πå‡∏™‡∏≥‡πÄ‡∏ô‡∏≤</span>
                            </label>
                        </div>
                        <div class="history-table-container">
                            <table class="data-table" id="historyTable">
                                <thead>
                                    <tr>
                                        <th>‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÉ‡∏ö‡∏Å‡∏≥‡∏Å‡∏±‡∏ö</th>
                                        <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
                                        <th>‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</th>
                                        <th>‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°</th>
                                        <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                                        <th>‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                                    </tr>
                                </thead>
                                <tbody id="historyBody">
                                    <!-- History will be loaded here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Settings Modal -->
    <div class="modal" id="settingsModal">
        <div class="modal-content modal-lg">
            <div class="modal-header">
                <h2>‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö</h2>
                <button class="modal-close" id="closeSettingsBtn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="settings-tabs">
                    <button class="settings-tab active" data-settings="company">üè¢ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó</button>
                    <button class="settings-tab" data-settings="invoice">üßæ ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÉ‡∏ö‡∏Å‡∏≥‡∏Å‡∏±‡∏ö</button>
                    <button class="settings-tab" data-settings="sheets">üìä Google Sheets</button>
                </div>

                <!-- Company Settings -->
                <div class="settings-content active" id="companySettings">
                    <div class="form-group">
                        <label>‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó/‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤</label>
                        <input type="text" id="companyName">
                    </div>
                    <div class="form-group">
                        <label>‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà</label>
                        <textarea id="companyAddress" rows="3"></textarea>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏ú‡∏π‡πâ‡πÄ‡∏™‡∏µ‡∏¢‡∏†‡∏≤‡∏©‡∏µ</label>
                            <input type="text" id="companyTaxId" maxlength="13">
                        </div>
                        <div class="form-group">
                            <label>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå</label>
                            <input type="tel" id="companyPhone">
                        </div>
                    </div>
                </div>

                <!-- Invoice Settings -->
                <div class="settings-content" id="invoiceSettings">
                    <div class="form-group">
                        <label>‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÉ‡∏ö‡∏Å‡∏≥‡∏Å‡∏±‡∏ö</label>
                        <input type="text" id="invoicePrefix" placeholder="‡πÄ‡∏ä‡πà‡∏ô INV-2024-" disabled>
                        <small class="form-hint">‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô: YYMMDDXXXX (‡πÄ‡∏ä‡πà‡∏ô 2601070001)</small>
                    </div>
                    <div class="form-group">
                        <label>üî¢ ‡πÄ‡∏•‡∏Ç‡∏£‡∏±‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ)</label>
                        <div style="display: flex; gap: 10px; align-items: center;">
                            <input type="number" id="invoiceCurrentNumber" min="1" value="1" style="flex: 1;">
                            <button type="button" class="btn btn-secondary" id="setInvoiceCounterBtn"
                                style="white-space: nowrap;">
                                ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏•‡∏Ç‡∏£‡∏±‡∏ô
                            </button>
                        </div>
                        <small class="form-hint">‡πÉ‡∏ö‡∏ñ‡∏±‡∏î‡πÑ‡∏õ‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡πÄ‡∏•‡∏Ç‡∏£‡∏±‡∏ô‡∏ô‡∏µ‡πâ (‡∏Å‡∏£‡∏ì‡∏µ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÄ‡∏•‡∏Ç‡∏£‡∏±‡∏ô)</small>
                    </div>
                    <div class="form-group" style="display: none;">
                        <label>‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô (‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ß‡πâ)</label>
                        <input type="number" id="invoiceStartNumber" min="1" value="1">
                    </div>
                    <div class="form-group" style="display: none;">
                        <label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏´‡∏•‡∏±‡∏Å‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà (‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ‡πÅ‡∏•‡πâ‡∏ß)</label>
                        <select id="invoiceNumberPadding">
                            <option value="3">3 ‡∏´‡∏•‡∏±‡∏Å (001)</option>
                            <option value="4" selected>4 ‡∏´‡∏•‡∏±‡∏Å (0001)</option>
                            <option value="5">5 ‡∏´‡∏•‡∏±‡∏Å (00001)</option>
                            <option value="6">6 ‡∏´‡∏•‡∏±‡∏Å (000001)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô</label>
                        <input type="text" id="defaultCategory" value="‡∏Ñ‡πà‡∏≤‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°">
                    </div>

                    <hr style="margin: 20px 0;">

                    <!-- Signature Upload -->
                    <div class="form-group">
                        <label>‚úçÔ∏è ‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô</label>
                        <div class="signature-upload-area" id="signatureUploadArea">
                            <img src="" alt="‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô" id="signaturePreview" class="hidden"
                                style="max-width: 150px; max-height: 60px;">
                            <div id="signaturePlaceholder">
                                <span>üìù ‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô</span>
                                <small>(‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö PNG, JPG)</small>
                            </div>
                            <input type="file" id="signatureInput" accept="image/*" hidden>
                        </div>
                        <button class="btn btn-secondary btn-sm" id="clearSignatureBtn" style="margin-top: 10px;">üóëÔ∏è
                            ‡∏•‡∏ö‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô</button>
                    </div>
                </div>

                <!-- Google Sheets Settings -->
                <div class="settings-content" id="sheetsSettings">
                    <div class="form-group">
                        <label>Google Sheet URL (‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤)</label>
                        <input type="url" id="sheetsUrl" placeholder="https://docs.google.com/spreadsheets/d/...">
                        <small class="form-hint">‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Sheet ‡πÄ‡∏õ‡πá‡∏ô "Anyone with the link can view"</small>
                    </div>
                    <div class="form-group">
                        <label>Google Apps Script URL (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•)</label>
                        <input type="url" id="scriptUrl" placeholder="https://script.google.com/macros/s/.../exec">
                        <small class="form-hint">‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏û‡∏¥‡πà‡∏°/‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÉ‡∏ö‡∏Å‡∏≥‡∏Å‡∏±‡∏ö</small>
                    </div>
                    <div class="btn-group">
                        <button class="btn btn-secondary" id="testConnectionBtn">üîó ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠</button>
                        <button class="btn btn-primary" id="syncDataBtn">üîÑ ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
                    </div>
                    <div class="connection-status" id="connectionStatus"></div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancelSettingsBtn">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                <button class="btn btn-primary" id="saveSettingsBtn">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</button>
            </div>
        </div>
    </div>

    <!-- Customer Modal -->
    <div class="modal" id="customerModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="customerModalTitle">üë§ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÉ‡∏´‡∏°‡πà</h2>
                <button class="modal-close" id="closeCustomerBtn">&times;</button>
            </div>
            <div class="modal-body">
                <input type="hidden" id="editCustomerId">
                <div class="form-group">
                    <label>‡∏£‡∏´‡∏±‡∏™‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</label>
                    <input type="text" id="modalCustomerId">
                </div>
                <div class="form-group">
                    <label>‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤/‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó <span class="required">*</span></label>
                    <input type="text" id="modalCustomerName" required>
                </div>
                <div class="form-group">
                    <label>‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà</label>
                    <textarea id="modalCustomerAddress" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label>‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏ú‡∏π‡πâ‡πÄ‡∏™‡∏µ‡∏¢‡∏†‡∏≤‡∏©‡∏µ</label>
                    <input type="text" id="modalCustomerTaxId" maxlength="13">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå</label>
                        <input type="tel" id="modalCustomerPhone">
                    </div>
                    <div class="form-group">
                        <label>Email</label>
                        <input type="email" id="modalCustomerEmail">
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancelCustomerBtn">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                <button class="btn btn-primary" id="saveCustomerBtn">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
            </div>
        </div>
    </div>

    <!-- Invoice Detail Modal -->
    <div class="modal" id="invoiceDetailModal">
        <div class="modal-content modal-lg">
            <div class="modal-header">
                <h2>üìÑ ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÉ‡∏ö‡∏Å‡∏≥‡∏Å‡∏±‡∏ö‡∏†‡∏≤‡∏©‡∏µ</h2>
                <button class="modal-close" id="closeDetailBtn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="invoice-preview" id="invoiceDetailPreview">
                    <!-- Invoice detail will be shown here -->
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="closeDetailModal">‡∏õ‡∏¥‡∏î</button>
                <button class="btn btn-primary" id="reprintBtn">üñ®Ô∏è ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ã‡πâ‡∏≥</button>
            </div>
        </div>
    </div>

    <!-- Email Invoice Modal -->
    <div class="modal" id="emailModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üìß ‡∏™‡πà‡∏á‡πÉ‡∏ö‡∏Å‡∏≥‡∏Å‡∏±‡∏ö‡∏†‡∏≤‡∏©‡∏µ‡∏ó‡∏≤‡∏á Email</h2>
                <button class="modal-close" id="closeEmailBtn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="email-preview-info"
                    style="background: #f7fafc; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                    <p style="margin: 0 0 10px 0; font-weight: 600;">üìÑ ‡πÉ‡∏ö‡∏Å‡∏≥‡∏Å‡∏±‡∏ö‡∏†‡∏≤‡∏©‡∏µ: <span
                            id="emailInvoiceNumber">-</span></p>
                    <p style="margin: 0 0 10px 0;">üë§ ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤: <span id="emailCustomerName">-</span></p>
                    <p style="margin: 0;">üí∞ ‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°: <span id="emailTotal">‡∏ø0.00</span></p>
                </div>

                <div class="form-group">
                    <label>üìß Email ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ <span class="required">*</span></label>
                    <input type="email" id="recipientEmail" placeholder="customer@example.com" required>
                    <small class="form-hint">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö email ‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡πà‡∏≠‡∏ô‡∏™‡πà‡∏á</small>
                </div>

                <!-- Signature Upload Section -->
                <div class="form-group">
                    <label>‚úçÔ∏è ‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô (‡∏à‡∏∞‡πÅ‡∏ô‡∏ö‡πÉ‡∏ô PDF)</label>
                    <div class="email-signature-area"
                        style="border: 2px dashed #cbd5e1; border-radius: 8px; padding: 15px; text-align: center; cursor: pointer; transition: all 0.2s;"
                        id="emailSignatureArea" onclick="document.getElementById('emailSignatureInput').click()">
                        <img id="emailSignaturePreview" src="" alt="‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô"
                            style="max-width: 200px; max-height: 80px; display: none;">
                        <div id="emailSignaturePlaceholder" style="color: #64748b;">
                            <span style="font-size: 24px;">üìù</span>
                            <p style="margin: 5px 0 0 0; font-size: 14px;">‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô
                                ‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÑ‡∏ß‡πâ</p>
                        </div>
                        <input type="file" id="emailSignatureInput" accept="image/*" style="display: none;">
                    </div>
                    <small class="form-hint">‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÉ‡∏´‡∏°‡πà ‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)</small>
                </div>

                <div class="email-notice"
                    style="background: #fffbeb; border: 1px solid #f59e0b; padding: 12px; border-radius: 8px; margin-top: 15px;">
                    <p style="margin: 0; font-size: 14px; color: #92400e;">
                        ‚ö†Ô∏è <strong>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:</strong> ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏™‡πà‡∏á email ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÅ‡∏ô‡∏ö‡πÉ‡∏ö‡∏Å‡∏≥‡∏Å‡∏±‡∏ö‡∏†‡∏≤‡∏©‡∏µ‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏ü‡∏•‡πå PDF ‡πÑ‡∏õ‡∏¢‡∏±‡∏á email
                        ‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏ö‡∏∏
                    </p>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancelEmailBtn">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                <button class="btn btn-primary" id="confirmSendEmailBtn">üìß ‡∏™‡πà‡∏á Email</button>
            </div>
        </div>
    </div>

    <!-- Loading Modal -->
    <div class="modal" id="loadingModal" style="z-index: 9999;">
        <div class="modal-content" style="max-width: 320px; text-align: center; padding: 30px;">
            <div class="loading-spinner"></div>
            <p id="loadingMessage" style="margin-top: 20px; font-size: 16px; color: #333;">
                ‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...
            </p>
        </div>
    </div>

    <!-- Print Template (Hidden) -->
    <div id="printTemplate" class="print-only">
        <!-- Print content will be generated here -->
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="js/storage.js"></script>
    <script src="js/sheets-api.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/invoice.js"></script>
    <script src="js/app.js"></script>
</body>

</html>